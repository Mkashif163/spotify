<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Playlists</title>
    <!-- Include Tailwind CSS CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header class="text-white-600 body-font">
        <div class="container mx-auto flex flex-wrap p-5 flex-col md:flex-row items-center">
            <a class="flex title-font font-medium items-center text-white-900 mb-4 md:mb-0">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/Spotify_logo_without_text.svg/2048px-Spotify_logo_without_text.svg.png"
                    alt="Spotify Logo" class="w-10 h-10 text-white p-2 bg-indigo-500 rounded-full">
                <span class="ml-3 text-xl">SpotLists</span>
            </a>
            <nav class="md:ml-auto md:mr-auto flex flex-wrap items-center text-base justify-center">
                <a class="mr-5 hover:text-white-900">Select Filter</a>
                <a class="mr-5 hover:text-white-900">
                    <select name="section" onchange="changeFilter(this.value)"
                        class="text-white bg-gray-800 border-0 px-3 py-2 focus:outline-none rounded text-base mt-4 md:mt-0">
                        <option value="featured" selected>Featured</option>
                        <option value="toplists">Top Lists</option>
                        <option value=0JQ5DAqbMKFQ00XGBls6ym>Hip-Hop</option>
                        <option value=0JQ5DAqbMKFEC4WFtoNRpw>Pop</option>
                        <option value=0JQ5DAqbMKFKLfwjuJMoNC>Country</option>
                        <option value=0JQ5DAqbMKFxXaXKP7zcDp>Latin</option>
                        <option value=0JQ5DAqbMKFDXXwE9BDJAr>Rock</option>
                        <option value=0JQ5DAqbMKFLVaM30PMBm4>Summer</option>
                        <option value=0JQ5DAqbMKFAXlCG6QvYQ4>Workout</option>
                        <option value=0JQ5DAqbMKFEZPnFQSFB1T>R&amp;B</option>
                        <option value=0JQ5DAqbMKFHOzuVTgTizF>Dance/Electronic</option>
                        <option value=0JQ5DAqbMKFEOEBCABAxo9>Netflix</option>
                        <option value=0JQ5DAqbMKFCWjUTdzaG0e>Indie</option>
                        <option value=0JQ5DAqbMKFzHmL4tf05da>Mood</option>
                        <option value=0JQ5DAqbMKFCuoRTxhYWow>Sleep</option>
                        <option value=0JQ5DAqbMKFy0OenPG51Av>Christian &amp; Gospel</option>
                        <option value=0JQ5DAqbMKFDTEtSaS4R92>Regional Mexican</option>
                        <option value=0JQ5DAqbMKFLb2EqgLtpjC>Wellness</option>
                        <option value=0JQ5DAqbMKFFzDl7qN9Apr>Chill</option>
                        <option value=0JQ5DAqbMKFPw634sFwguI>EQUAL</option>
                        <option value=0JQ5DAqbMKFCfObibaOZbv>Gaming</option>
                        <option value=0JQ5DAqbMKFF9bY76LXmfI>Frequency</option>
                        <option value=0JQ5DAqbMKFFoimhOqWzLB>Kids &amp; Family</option>
                        <option value=0JQ5DAqbMKFA6SOHvT3gck>Party</option>
                        <option value=0JQ5DAqbMKFIVNxQgRNSg0>Decades</option>
                        <option value=0JQ5DAqbMKFImHYGo3eTSg>Fresh Finds</option>
                        <option value=0JQ5DAqbMKFAJ5xb0fwo9m>Jazz</option>
                        <option value=0JQ5DAqbMKFCbimwdOYlsl>Focus</option>
                        <option value=0JQ5DAqbMKFAUsdyVjCQuL>Romance</option>
                        <option value=0JQ5DAqbMKFy78wprEpAjl>Folk &amp; Acoustic</option>
                        <option value=0JQ5DAqbMKFGvOw3O4nLAf>K-Pop</option>
                        <option value=0JQ5DAqbMKFRieVZLLoo9m>Instrumental</option>
                        <option value=0JQ5DAqbMKFLjmiZRss79w>Ambient</option>
                        <option value=0JQ5DAqbMKFFtlLYUHv8bT>Alternative</option>
                        <option value=0JQ5DAqbMKFIRybaNTYXXy>In the car</option>
                        <option value=0JQ5DAqbMKFPrEiAOxgac3>Classical</option>
                        <option value=0JQ5DAqbMKFIpEuaCnimBj>Soul</option>
                        <option value=0JQ5DAqbMKFDBgllo2cUIN>Spotify Singles</option>
                        <option value=0JQ5DAqbMKFRY5ok2pxXJ0>Cooking &amp; Dining</option>
                        <option value=0JQ5DAqbMKFAjfauKLOZiv>Punk</option>
                        <option value=0JQ5DAqbMKFQIL0AXnG5AK>Pop culture</option>
                        <option value=0JQ5DAqbMKFQiK2EHwyjcU>Blues</option>
                        <option value=0JQ5DAqbMKFQVdc2eQoH2s>Desi</option>
                        <option value=0JQ5DAqbMKFQ1UFISXj59F>Arab</option>
                        <option value=0JQ5DAqbMKFOOxftoKZxod>RADAR</option>
                        <option value=0JQ5DAqbMKFJw7QLnM27p6>Student</option>
                        <option value=0JQ5DAqbMKFziKOShCi009>Anime</option>
                        <option value=0JQ5DAqbMKFRKBHIxJ5hMm>Tastemakers</option>
                        <option value=0JQ5DAqbMKFNQ0fGp4byGU>Afro</option>
                        <option value=comedy>Comedy</option>
                        <option value=0JQ5DAqbMKFDkd668ypn6O>Metal</option>
                        <option value=0JQ5DAqbMKFObNLOHydSW8>Caribbean</option>
                        <option value=0JQ5DAqbMKFFsW9N8maB6z>Funk &amp; Disco</option>
                    </select></a>

            </nav>

        </div>
    </header>
    <div class="container mx-auto my-5">
        <div id="globalContainer">
            <h2 class="text-4xl font-semibold mb-3">Top Playlists Global</h2>
        </div>
        <div id="pkContainer">
            <h2 class="text-4xl font-semibold mb-3">Top Playlists Pakistan</h2>
        </div>
        <div id="usContainer">
            <h2 class="text-4xl font-semibold mb-3">Top Playlists US</h2>
        </div>


        <script>
            // Spotify API credentials
            const clientId = 'b180920d0d0f411b98bfdeedab00615a';
            const clientSecret = '4292c7c09db34ad99b169c3d86ff2196';

            // Spotify API endpoints
            const tokenEndpoint = 'https://accounts.spotify.com/api/token';
            const featuredPlaylistsEndpoint = 'https://api.spotify.com/v1/browse/featured-playlists';
            const categoryPlaylistsEndpoint = 'https://api.spotify.com/v1/browse/categories/{category_id}/playlists';

            // Function to get access token
            async function getAccessToken() {
                const response = await fetch(tokenEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Authorization': 'Basic ' + btoa(clientId + ':' + clientSecret),
                    },
                    body: 'grant_type=client_credentials',
                });

                const data = await response.json();
                return data.access_token;
            }

            // Function to get playlists based on the selected filter
            async function getPlaylists(filter, countryCode) {
                try {
                    const accessToken = await getAccessToken();
                    let response;

                    if (filter === 'featured') {
                        if (countryCode) {
                            response = await fetch(featuredPlaylistsEndpoint + `?country=${countryCode}`, {
                                headers: {
                                    'Authorization': 'Bearer ' + accessToken,
                                },
                            });
                        } else {
                            response = await fetch(featuredPlaylistsEndpoint, {
                                headers: {
                                    'Authorization': 'Bearer ' + accessToken,
                                },
                            });
                        }
                    } else {
                        const categoryId = filter;
                        response = await fetch(categoryPlaylistsEndpoint.replace('{category_id}', categoryId) + `?country=${countryCode}`, {
                            headers: {
                                'Authorization': 'Bearer ' + accessToken,
                            },
                        });
                    }

                    const data = await response.json();
                    return data.playlists.items;

                } catch (error) {
                    console.error('Error:', error);
                    return [];
                }
            }

            // Function to display playlists
            function displayPlaylists(playlists, country, containerId) {
                const playlistsHtml = playlists.map(playlist => {
                    return `<div class="p-4 md:w-1/6 sm:mb-0 mb-6 ">
            <div class="rounded-lg h-40  overflow-hidden">
                <img alt="${playlist.name}" class="object-cover object-center h-full w-full" src="${playlist.images[0].url}">
            </div>
            <h2 class="text-lg font-medium title-font  mt-5">${playlist.name}</h2>
            <p class="text-base leading-relaxed mt-1">${playlist.description}</p>
            <a class="text-indigo-500 inline-flex items-center mt-3" href="${playlist.external_urls.spotify}" target="_blank">Listen on Spotify
                <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    class="w-4 h-4 ml-2" viewBox="0 0 24 24">
                    <path d="M5 12h14M12 5l7 7-7 7"></path>
                </svg>
            </a>
        </div>`;
                }).join('');

                const playlistsContainer = document.getElementById(containerId);

                // Replace content with new playlists
                playlistsContainer.innerHTML = `<div class="mb-10"><h2 class="text-4xl font-semibold mb-3">Top Playlists ${country}</h2><div class="flex flex-wrap sm:-m-2 -mx-2 -mb-4 -mt-2">${playlistsHtml}</div></div>`;
            }

            async function init() {
                const initialFilter = 'featured';

                // Get the selected countries from the div elements
                const countryElements = document.querySelectorAll('#featuredPlaylists div');
                const countries = Array.from(countryElements).map(element => element.getAttribute('value'));

                // Fetch and display playlists for Pakistan and US
                const playlistsGlobal = await getPlaylists(initialFilter);
                displayPlaylists(playlistsGlobal, 'Global', 'globalContainer');

                const playlistsPK = await getPlaylists(initialFilter, 'PK');
                displayPlaylists(playlistsPK, 'Pakistan', 'pkContainer');

                const playlistsUS = await getPlaylists(initialFilter, 'US');
                displayPlaylists(playlistsUS, 'US', 'usContainer');
            }

            // Function to handle filter change
            async function changeFilter(selectedFilter) {
                // Fetch and display playlists for Pakistan and US
                const playlistsGlobal = await getPlaylists(selectedFilter);
                displayPlaylists(playlistsGlobal, 'Global', 'globalContainer');

                const playlistsPK = await getPlaylists(selectedFilter, 'PK');
                displayPlaylists(playlistsPK, 'Pakistan', 'pkContainer');

                const playlistsUS = await getPlaylists(selectedFilter, 'US');
                displayPlaylists(playlistsUS, 'US', 'usContainer');
            }

            // Call the init function to load global playlists initially
            init();
        </script>

</body>

</html>